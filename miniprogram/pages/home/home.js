"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const request_service_1 = require("../../services/request-service");
const authen_service_1 = require("../../services/authen-service");
Page({
    data: {
        scrollHeight: '',
        background: [
            "../../img/swiperA.jpg",
            "../../img/swiperB.jpg",
            "../../img/swiperC.jpg"
        ],
        indicatorDots: true,
        vertical: false,
        autoplay: false,
        interval: 2000,
        duration: 500,
        indexImg: 0,
        option: [],
        optionShow: '',
        labelBoxIsNull: true,
        itemTitle: '行业',
        onlineSession: '',
        isHistory: '',
        isMyCollected: '',
    },
    onLoad: function () {
        let that = this;
        for (let i = 0; i < that.data.option.length; i++) {
            var option = "option[" + i + "].isSelect";
            that.setData({
                [option]: false
            });
        }
        this.getBarImg();
        this.getOnlineSession();
        this.getAllBusiness();
    },
    onReady: function () {
        const that = this;
        that.computeScrollViewHeight();
    },
    onShow: function () {
        if (typeof this.getTabBar === 'function' &&
            this.getTabBar()) {
            this.getTabBar().setData({
                selected: 0
            });
        }
    },
    onHide: function () {
    },
    onUnload: function () {
    },
    onPullDownRefresh: function () {
    },
    onReachBottom: function () {
    },
    onShareAppMessage: function () {
    },
    getBarImg() {
        request_service_1.requestService.get('onlinePresentationsBanners/', {})
            .then(res => {
            console.log('轮播', res);
        });
    },
    getOnlineSession() {
        const that = this;
        request_service_1.requestService.get('onlinePresentations/', {}).then(res => {
            for (let i = 0; i < res.data.data.length; i++) {
                res.data.data[i].updateDate = this.timeHandle(res.data.data[i].updateDate);
            }
            that.setData({
                onlineSession: res.data.data
            });
        });
    },
    timeHandle(dateTime) {
        let date = dateTime.split(' ')[0];
        let time = dateTime.split(' ')[1];
        let dateNew = date.split('-')[1] + '-' + date.split('-')[2];
        let timeNew = time.split(':')[0] + ':' + time.split(':')[1];
        return (dateNew + ' ' + timeNew);
    },
    indexChange(event) {
        let that = this;
        console.log(event);
        var index = event.detail.current;
        that.setData({
            indexImg: index
        });
    },
    searchInput(e) {
        const that = this;
        that.getAllBusiness(e.detail.value);
        const business = e.detail.value;
        request_service_1.requestService.get('onlinePresentations/keyword/', { business }, {}, true, true)
            .then(res => {
            that.setData({
                onlineSession: res.data.data
            });
        });
    },
    searchIsNull(e) {
        const that = this;
        if (!e.detail.value) {
            that.getOnlineSession();
        }
    },
    clickLabel(event) {
        const that = this;
        console.log(event.currentTarget.dataset.info);
        const info = event.currentTarget.dataset.info;
        let isSelect = that.data.option[info].isSelect;
        var option = "option[" + info + "].isSelect";
        if (!isSelect) {
            var selected = "option[" + that.data.optionShow + "].isSelect";
            that.setData({
                [option]: !isSelect
            });
            if (that.data.optionShow !== '') {
                that.setData({
                    [selected]: !that.data.option[that.data.optionShow].isSelect
                });
            }
            that.setData({
                optionShow: info
            });
        }
        else {
            that.setData({
                [option]: !isSelect,
                optionShow: ''
            });
        }
        let isNull = true;
        if (that.data.optionShow === '') {
            isNull = true;
            that.getOnlineSession();
        }
        else {
            isNull = false;
            that.getAllBusiness(that.data.option[that.data.optionShow].name);
        }
        that.setData({
            labelBoxIsNull: isNull
        });
    },
    getAllBusiness(business) {
        const that = this;
        if (business) {
            request_service_1.requestService.get('onlinePresentations/business/', { business }, {}, true, true)
                .then(res => {
                that.setData({
                    onlineSession: res.data.data
                });
            });
        }
        else {
            request_service_1.requestService.get('onlinePresentations/business/', {})
                .then(res => {
                that.setData({
                    option: res.data.data
                });
            });
        }
    },
    isHistory() {
        const that = this;
        if (that.data.isHistory == '') {
            that.setData({
                isHistory: true
            });
        }
        else {
            that.setData({
                isHistory: !that.data.isHistory
            });
        }
    },
    isMyCollect() {
        const that = this;
        const business = authen_service_1.authenService.getUserId();
        if (that.data.isMyCollected) {
            that.setData({
                isMyCollected: !that.data.isMyCollected
            });
            request_service_1.requestService.get('onlinePresentations/', {})
                .then(res => {
                that.setData({
                    onlineSession: res.data.data
                });
            });
        }
        else {
            that.setData({
                isMyCollected: true
            });
            request_service_1.requestService.get("collect/onlinePresentations/user/", { business }, {}, true, true)
                .then(res => {
                that.setData({
                    onlineSession: res.data.data
                });
            });
        }
    },
    computeScrollViewHeight() {
        const that = this;
        let query = wx.createSelectorQuery();
        query.select('.swiper-wrap').boundingClientRect();
        query.select('.contentHead').boundingClientRect();
        query.exec(res => {
            let swiperHeight = res[0].height;
            let headHeight = res[1].height;
            let windowHeight = wx.getSystemInfoSync().windowHeight;
            let scrollHeight = windowHeight - swiperHeight - headHeight - 50;
            that.setData({
                scrollHeight: scrollHeight
            });
        });
    },
    toCloud(e) {
        const that = this;
        let info = e.currentTarget.dataset.info;
        let data = that.data.onlineSession[info];
        const sendData = JSON.stringify(data);
        wx.navigateTo({
            url: '../cloud/cloud?data=' + sendData
        });
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaG9tZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImhvbWUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFDQSxvRUFBOEQ7QUFDOUQsa0VBQTREO0FBRTVELElBQUksQ0FBQztJQUtELElBQUksRUFBRTtRQUNGLFlBQVksRUFBQyxFQUFFO1FBQ2YsVUFBVSxFQUFFO1lBQ1IsdUJBQXVCO1lBQ3ZCLHVCQUF1QjtZQUN2Qix1QkFBdUI7U0FDMUI7UUFDRCxhQUFhLEVBQUUsSUFBSTtRQUNuQixRQUFRLEVBQUUsS0FBSztRQUNmLFFBQVEsRUFBRSxLQUFLO1FBQ2YsUUFBUSxFQUFFLElBQUk7UUFDZCxRQUFRLEVBQUUsR0FBRztRQUNiLFFBQVEsRUFBRSxDQUFDO1FBRVgsTUFBTSxFQUFDLEVBV047UUFJRCxVQUFVLEVBQUMsRUFBRTtRQUViLGNBQWMsRUFBQyxJQUFJO1FBQ25CLFNBQVMsRUFBQyxJQUFJO1FBRWQsYUFBYSxFQUFDLEVBQUU7UUFFaEIsU0FBUyxFQUFDLEVBQUU7UUFDWixhQUFhLEVBQUMsRUFBRTtLQUNuQjtJQUtELE1BQU0sRUFBRTtRQUNKLElBQUksSUFBSSxHQUFHLElBQVcsQ0FBQztRQUV2QixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO1lBQzlDLElBQUksTUFBTSxHQUFHLFNBQVMsR0FBQyxDQUFDLEdBQUMsWUFBWSxDQUFDO1lBQ3RDLElBQUksQ0FBQyxPQUFPLENBQUM7Z0JBQ1QsQ0FBQyxNQUFNLENBQUMsRUFBQyxLQUFLO2FBQ2pCLENBQUMsQ0FBQztTQUNOO1FBRUQsSUFBSSxDQUFDLFNBQVMsRUFBRSxDQUFDO1FBQ2pCLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQ3hCLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUUxQixDQUFDO0lBS0QsT0FBTyxFQUFFO1FBQ0wsTUFB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WSxHQUFHLFlBQVksR0FBRyxZQUFZLEdBQUcsVUFBVSxHQUFHLEVBQUUsQ0FBQztZQUNqRSxJQUFJLENBQUMsT0FBTyxDQUFDO2dCQUNULFlBQVksRUFBRSxZQUFZO2FBQzdCLENBQUMsQ0FBQTtRQUNOLENBQUMsQ0FBQyxDQUFBO0lBQ04sQ0FBQztJQUNELE9BQU8sQ0FBQyxDQUFLO1FBQ1QsTUFBTSxJQUFJLEdBQUcsSUFBVyxDQUFDO1FBQ3pCLElBQUksSUFBSSxHQUFHLENBQUMsQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQztRQUN4QyxJQUFJLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN6QyxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3RDLEVBQUUsQ0FBQyxVQUFVLENBQUM7WUFDVixHQUFHLEVBQUMsc0JBQXNCLEdBQUcsUUFBUTtTQUN4QyxDQUFDLENBQUE7SUFDTixDQUFDO0NBQ0osQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiLy8gLy8gbWluaXByb2dyYW0vcGFnZXMvaG9tZS9ob21lLmpzXHJcbmltcG9ydCB7cmVxdWVzdFNlcnZpY2V9IGZyb20gXCIuLi8uLi9zZXJ2aWNlcy9yZXF1ZXN0LXNlcnZpY2VcIjtcclxuaW1wb3J0IHthdXRoZW5TZXJ2aWNlfSBmcm9tIFwiLi4vLi4vc2VydmljZXMvYXV0aGVuLXNlcnZpY2VcIjtcclxuXHJcblBhZ2Uoe1xyXG5cclxuICAgIC8qKlxyXG4gICAgICog6aG16Z2i55qE5Yid5aeL5pWw5o2uXHJcbiAgICAgKi9cclxuICAgIGRhdGE6IHtcclxuICAgICAgICBzY3JvbGxIZWlnaHQ6JycsXHJcbiAgICAgICAgYmFja2dyb3VuZDogW1xyXG4gICAgICAgICAgICBcIi4uLy4uL2ltZy9zd2lwZXJBLmpwZ1wiLFxyXG4gICAgICAgICAgICBcIi4uLy4uL2ltZy9zd2lwZXJCLmpwZ1wiLFxyXG4gICAgICAgICAgICBcIi4uLy4uL2ltZy9zd2lwZXJDLmpwZ1wiXHJcbiAgICAgICAgXSxcclxuICAgICAgICBpbmRpY2F0b3JEb3RzOiB0cnVlLFxyXG4gICAgICAgIHZlcnRpY2FsOiBmYWxzZSxcclxuICAgICAgICBhdXRvcGxheTogZmFsc2UsXHJcbiAgICAgICAgaW50ZXJ2YWw6IDIwMDAsXHJcbiAgICAgICAgZHVyYXRpb246IDUwMCxcclxuICAgICAgICBpbmRleEltZzogMCxcclxuICAgICAgICAvLyDkuIvmi4noj5zljZVcclxuICAgICAgICBvcHRpb246W1xyXG4gICAgICAgICAgICAvLyB7bmFtZTon5LqS6IGU572RJ30sXHJcbiAgICAgICAgICAgIC8vIHtuYW1lOifph5Hono0nfSxcclxuICAgICAgICAgICAgLy8ge25hbWU6J+Wcn+acqOW3peeoiyd9LFxyXG4gICAgICAgICAgICAvLyB7bmFtZTon5YyW5a2m5LiO546v5aKD5rWL6K+VJ30sXHJcbiAgICAgICAgICAgIC8vIHtuYW1lOifnlJ/niannu5PmnoTkuI7npL7kvJrkurrmlocnfSxcclxuICAgICAgICAgICAgLy8ge25hbWU6J+WkqeWcsOS6uuWSjOiNieacqOWFseeUn+S4h+eJqeWSjOiwkCd9LFxyXG4gICAgICAgICAgICAvLyB7bmFtZTon5LqS6IGU572RJ30sXHJcbiAgICAgICAgICAgIC8vIHtuYW1lOifkupLogZTnvZEnfSxcclxuICAgICAgICAgICAgLy8ge25hbWU6J+S6kuiBlOe9kSd9LFxyXG4gICAgICAgICAgICAvLyB7bmFtZTon5LqS6IGU572RJ30sXHJcbiAgICAgICAgXSxcclxuICAgICAgICAvLyDlrZjmoIfnrb7kuIvmoIfnmoTmlbDnu4RcclxuICAgICAgICAvLyBvcHRpb25TaG93OltdLFxyXG4gICAgICAgIC8vIOWtmOagh+etvuS4i+agh1xyXG4gICAgICAgIG9wdGlvblNob3c6JycsXHJcbiAgICAgICAgLy8g5piv5ZCm5pi+56S6bGFiZWxCb3hcclxuICAgICAgICBsYWJlbEJveElzTnVsbDp0cnVlLFxyXG4gICAgICAgIGl0ZW1UaXRsZTon6KGM5LiaJyxcclxuICAgICAgICAvLyDnur/kuIrlrqPorrLkvJror6bmg4VcclxuICAgICAgICBvbmxpbmVTZXNzaW9uOicnLFxyXG4gICAgICAgIC8vIOaYr+WQpuaYr+W+gOWxilxyXG4gICAgICAgIGlzSGlzdG9yeTonJyxcclxuICAgICAgICBpc015Q29sbGVjdGVkOicnLFxyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIOeUn+WRveWRqOacn+WHveaVsC0t55uR5ZCs6aG16Z2i5Yqg6L29XHJcbiAgICAgKi9cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGxldCB0aGF0ID0gdGhpcyBhcyBhbnk7XHJcbiAgICAgICAgLy8g57uZ5pWw5o2u5re75Yqg5piv5ZCm6YCJ5Lit5a2X5q61XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGF0LmRhdGEub3B0aW9uLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBvcHRpb24gPSBcIm9wdGlvbltcIitpK1wiXS5pc1NlbGVjdFwiO1xyXG4gICAgICAgICAgICB0aGF0LnNldERhdGEoe1xyXG4gICAgICAgICAgICAgICAgW29wdGlvbl06ZmFsc2VcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOi9ruaSreWbvlxyXG4gICAgICAgIHRoaXMuZ2V0QmFySW1nKCk7XHJcbiAgICAgICAgdGhpcy5nZXRPbmxpbmVTZXNzaW9uKCk7XHJcbiAgICAgICAgdGhpcy5nZXRBbGxCdXNpbmVzcygpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDnlJ/lkb3lkajmnJ/lh73mlbAtLeebkeWQrOmhtemdouWIneasoea4suafk+WujOaIkFxyXG4gICAgICovXHJcbiAgICBvblJlYWR5OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY29uc3QgdGhhdCA9IHRoaXMgYXMgYW55O1xyXG4gICAgICAgIHRoYXQuY29tcHV0ZVNjcm9sbFZpZXdIZWlnaHQoKTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDnlJ/lkb3lkajmnJ/lh73mlbAtLeebkeWQrOmhtemdouaYvuekulxyXG4gICAgICovXHJcbiAgICBvblNob3c6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodHlwZW9mIHRoaXMuZ2V0VGFiQmFyID09PSAnZnVuY3Rpb24nICYmXHJcbiAgICAgICAgICAgIHRoaXMuZ2V0VGFiQmFyKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5nZXRUYWJCYXIoKS5zZXREYXRhKHtcclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkOiAwXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIOeUn+WRveWRqOacn+WHveaVsC0t55uR5ZCs6aG16Z2i6ZqQ6JePXHJcbiAgICAgKi9cclxuICAgIG9uSGlkZTogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDnlJ/lkb3lkajmnJ/lh73mlbAtLeebkeWQrOmhtemdouWNuOi9vVxyXG4gICAgICovXHJcbiAgICBvblVubG9hZDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDpobXpnaLnm7jlhbPkuovku7blpITnkIblh73mlbAtLeebkeWQrOeUqOaIt+S4i+aLieWKqOS9nFxyXG4gICAgICovXHJcbiAgICBvblB1bGxEb3duUmVmcmVzaDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDpobXpnaLkuIrmi4nop6blupXkuovku7bnmoTlpITnkIblh73mlbBcclxuICAgICAqL1xyXG4gICAgb25SZWFjaEJvdHRvbTogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDnlKjmiLfngrnlh7vlj7PkuIrop5LliIbkuqtcclxuICAgICAqL1xyXG4gICAgb25TaGFyZUFwcE1lc3NhZ2U6IGZ1bmN0aW9uICgpIDphbnl7XHJcblxyXG4gICAgfSxcclxuICAgIC8vIOi9ruaSreWbvlxyXG4gICAgZ2V0QmFySW1nKCl7XHJcbiAgICAgICAgcmVxdWVzdFNlcnZpY2UuZ2V0KCdvbmxpbmVQcmVzZW50YXRpb25zQmFubmVycy8nLHt9KVxyXG4gICAgICAgICAgICAudGhlbihyZXM9PntcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfova7mkq0nLHJlcyk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICB9LFxyXG4gICAgLy8g57q/5LiK5a6j6K6y6K+m5oOFXHJcbiAgICBnZXRPbmxpbmVTZXNzaW9uKCl7XHJcbiAgICAgICAgY29uc3QgdGhhdCA9IHRoaXMgYXMgYW55O1xyXG4gICAgICAgIHJlcXVlc3RTZXJ2aWNlLmdldCgnb25saW5lUHJlc2VudGF0aW9ucy8nLHt9KS50aGVuKHJlcz0+e1xyXG4gICAgICAgICAgICAvLyDlsIblkI7lj7Dml7bpl7TmoLzlvI/ljJbkuLowMS0xNSAwNDoxNeagvOW8j1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlcy5kYXRhLmRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHJlcy5kYXRhLmRhdGFbaV0udXBkYXRlRGF0ZSA9IHRoaXMudGltZUhhbmRsZShyZXMuZGF0YS5kYXRhW2ldLnVwZGF0ZURhdGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoYXQuc2V0RGF0YSh7XHJcbiAgICAgICAgICAgICAgICBvbmxpbmVTZXNzaW9uOnJlcy5kYXRhLmRhdGFcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSlcclxuICAgIH0sXHJcbiAgICAvLyDml7bpl7TlpITnkIblh73mlbBcclxuICAgIHRpbWVIYW5kbGUoZGF0ZVRpbWU6c3RyaW5nKXtcclxuICAgICAgICBsZXQgZGF0ZSA9IGRhdGVUaW1lLnNwbGl0KCcgJylbMF07XHJcbiAgICAgICAgbGV0IHRpbWUgPSBkYXRlVGltZS5zcGxpdCgnICcpWzFdO1xyXG4gICAgICAgIGxldCBkYXRlTmV3ID0gZGF0ZS5zcGxpdCgnLScpWzFdICsgJy0nICsgZGF0ZS5zcGxpdCgnLScpWzJdO1xyXG4gICAgICAgIGxldCB0aW1lTmV3ID0gdGltZS5zcGxpdCgnOicpWzBdICsgJzonICsgdGltZS5zcGxpdCgnOicpWzFdO1xyXG4gICAgICAgIHJldHVybiAoZGF0ZU5ldyArICcgJyArIHRpbWVOZXcpO1xyXG4gICAgfSxcclxuICAgIGluZGV4Q2hhbmdlKGV2ZW50OmFueSl7XHJcbiAgICAgICAgbGV0IHRoYXQgPSB0aGlzIGFzIGFueTtcclxuICAgICAgICBjb25zb2xlLmxvZyhldmVudCk7XHJcbiAgICAgICAgdmFyIGluZGV4ID0gZXZlbnQuZGV0YWlsLmN1cnJlbnQ7XHJcbiAgICAgICAgdGhhdC5zZXREYXRhKHtcclxuICAgICAgICAgICAgaW5kZXhJbWc6IGluZGV4XHJcbiAgICAgICAgfSlcclxuICAgIH0sXHJcbiAgICAvLyDmkJzntKLmoYZcclxuICAgIC8vIOeCueWHu+WujOaIkFxyXG4gICAgc2VhcmNoSW5wdXQoZTphbnkpe1xyXG4gICAgICAgIGNvbnN0IHRoYXQgPSB0aGlzIGFzIGFueTtcclxuICAgICAgICB0aGF0LmdldEFsbEJ1c2luZXNzKGUuZGV0YWlsLnZhbHVlKTtcclxuICAgICAgICBjb25zdCBidXNpbmVzcyA9IGUuZGV0YWlsLnZhbHVlO1xyXG4gICAgICAgIHJlcXVlc3RTZXJ2aWNlLmdldCgnb25saW5lUHJlc2VudGF0aW9ucy9rZXl3b3JkLycse2J1c2luZXNzfSx7fSx0cnVlLHRydWUpXHJcbiAgICAgICAgICAgIC50aGVuKHJlcz0+e1xyXG4gICAgICAgICAgICAgICAgdGhhdC5zZXREYXRhKHtcclxuICAgICAgICAgICAgICAgICAgICBvbmxpbmVTZXNzaW9uOnJlcy5kYXRhLmRhdGFcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgfSxcclxuICAgIC8vIOWkseeEpuaXtlxyXG4gICAgc2VhcmNoSXNOdWxsKGU6YW55KXtcclxuICAgICAgICBjb25zdCB0aGF0ID0gdGhpcyBhcyBhbnk7XHJcbiAgICAgICAgLy8g6Iul6L6T5YWl5qGG5Li656m677yM5YiZ5p+l6K+i5omA5pyJXHJcbiAgICAgICAgaWYgKCFlLmRldGFpbC52YWx1ZSkge1xyXG4gICAgICAgICAgICB0aGF0LmdldE9ubGluZVNlc3Npb24oKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy8g54K55Ye75qCH562+6Kem5Y+R77yI5Y2V6YCJ77yJXHJcbiAgICBjbGlja0xhYmVsKGV2ZW50OmFueSl7XHJcbiAgICAgICAgY29uc3QgdGhhdCA9IHRoaXMgYXMgYW55O1xyXG4gICAgICAgIC8vIOeCueWHu+agh+etvuWIh+aNouWvueW6lOagh+etvumAieS4reeKtuaAgVxyXG4gICAgICAgIGNvbnNvbGUubG9nKGV2ZW50LmN1cnJlbnRUYXJnZXQuZGF0YXNldC5pbmZvKTtcclxuICAgICAgICBjb25zdCBpbmZvID0gZXZlbnQuY3VycmVudFRhcmdldC5kYXRhc2V0LmluZm87XHJcbiAgICAgICAgbGV0IGlzU2VsZWN0ID0gdGhhdC5kYXRhLm9wdGlvbltpbmZvXS5pc1NlbGVjdDtcclxuICAgICAgICB2YXIgb3B0aW9uID0gXCJvcHRpb25bXCIraW5mbytcIl0uaXNTZWxlY3RcIjtcclxuICAgICAgICBpZiAoIWlzU2VsZWN0KXtcclxuICAgICAgICAgICAgLy9pc1NlbGVjdOS4umZhbHNlIOWmguaenOWNs+Wwhuiiq+eCueS6ru+8jOWImeWwhuWFtuS4i+agh2luZm/lrZjlhaVvcHRpb25TaG93IOS7peS+v+eCueS6ruWPpuS4gOS4queahOaXtuWAmeWlveaJvuWIsOWug+WPlua2iOeCueS6rlxyXG4gICAgICAgICAgICAvLyDmlLnlj5jmoIfnrb7pgInkuK3nirbmgIFcclxuICAgICAgICAgICAgdmFyIHNlbGVjdGVkID0gXCJvcHRpb25bXCIrdGhhdC5kYXRhLm9wdGlvblNob3crXCJdLmlzU2VsZWN0XCI7XHJcbiAgICAgICAgICAgIHRoYXQuc2V0RGF0YSh7XHJcbiAgICAgICAgICAgICAgICBbb3B0aW9uXTohaXNTZWxlY3RcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8vIOWPlua2iOS4iuS4gOS4queCueS6rueahOagh+etvlxyXG4gICAgICAgICAgICBpZiAodGhhdC5kYXRhLm9wdGlvblNob3chPT0nJykge1xyXG4gICAgICAgICAgICAgICAgdGhhdC5zZXREYXRhKHtcclxuICAgICAgICAgICAgICAgICAgICBbc2VsZWN0ZWRdOiF0aGF0LmRhdGEub3B0aW9uW3RoYXQuZGF0YS5vcHRpb25TaG93XS5pc1NlbGVjdFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8g5a2Y5YWl54K55Lqu5qCH562+55qEaW5mb1xyXG4gICAgICAgICAgICB0aGF0LnNldERhdGEoe1xyXG4gICAgICAgICAgICAgICAgb3B0aW9uU2hvdzppbmZvXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIOWPlua2iOagh+etvumAieS4reeKtuaAgSDnva4nJ+e7mW9wdGlvblNob3dcclxuICAgICAgICAgICAgdGhhdC5zZXREYXRhKHtcclxuICAgICAgICAgICAgICAgIFtvcHRpb25dOiFpc1NlbGVjdCxcclxuICAgICAgICAgICAgICAgIG9wdGlvblNob3c6JydcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOWmguaenG9wdGlvblNob3fkuLrnqbrvvIzor7TmmI7msqHmnInmoIfnrb7ooqvpgInkuK0g5YiZbGFiZWxCb3jkuLrnqbrvvIzotYvnu5lsYWJlbEJveElzTnVsbCDvvJp0cnVlIOWcqHd4bWzkuIrkuI3kuojmmL7npLpcclxuICAgICAgICBsZXQgaXNOdWxsID0gdHJ1ZTtcclxuICAgICAgICBpZiAodGhhdC5kYXRhLm9wdGlvblNob3cgPT09ICcnKSB7XHJcbiAgICAgICAgICAgIGlzTnVsbCA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vIOagh+etvuiiq+WPlua2iOWImeafpeivouaYvuekuuaJgOacieeahOWuo+iusuS8mlxyXG4gICAgICAgICAgICB0aGF0LmdldE9ubGluZVNlc3Npb24oKTtcclxuICAgICAgICB9ZWxzZSB7XHJcbiAgICAgICAgICAgIGlzTnVsbCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGF0LmdldEFsbEJ1c2luZXNzKHRoYXQuZGF0YS5vcHRpb25bdGhhdC5kYXRhLm9wdGlvblNob3ddLm5hbWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGF0LnNldERhdGEoe1xyXG4gICAgICAgICAgICBsYWJlbEJveElzTnVsbDppc051bGxcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbiAgICAvLyDngrnlh7vmoIfnrb7op6blj5HvvIjlj6/lpJrpgInvvIlcclxuICAgIC8vIGNsaWNrTGFiZWwoZXZlbnQ6YW55KXtcclxuICAgIC8vICAgICBsZXQgdGhhdCA9IHRoaXMgYXMgYW55O1xyXG4gICAgLy8gICAgIC8vIOeCueWHu+agh+etvuWIh+aNouWvueW6lOagh+etvumAieS4reeKtuaAgVxyXG4gICAgLy8gICAgIGNvbnNvbGUubG9nKGV2ZW50LmN1cnJlbnRUYXJnZXQuZGF0YXNldC5pbmZvKTtcclxuICAgIC8vICAgICBjb25zdCBpbmZvID0gZXZlbnQuY3VycmVudFRhcmdldC5kYXRhc2V0LmluZm87XHJcbiAgICAvLyAgICAgbGV0IGlzU2VsZWN0ID0gdGhhdC5kYXRhLm9wdGlvbltpbmZvXS5pc1NlbGVjdDtcclxuICAgIC8vICAgICB2YXIgb3B0aW9uID0gXCJvcHRpb25TaG93W1wiK2luZm8rXCJdXCI7XHJcbiAgICAvLyAgICAgaWYgKCFpc1NlbGVjdCl7XHJcbiAgICAvLyAgICAgICAgIC8vaXNTZWxlY3TkuLpmYWxzZSDlpoLmnpzljbPlsIbooqvngrnkuq7vvIzliJnlsIblhbbkuIvmoIdpbmZv5Yqg5YWlb3B0aW9uU2hvd+aVsOe7hOeahGluZm/kvY3nva4g5Lul5L6/5Yig6Zmk55qE5pe25YCZ5aW95om+5YiwXHJcbiAgICAvLyAgICAgICAgIHRoYXQuc2V0RGF0YSh7XHJcbiAgICAvLyAgICAgICAgICAgICBbb3B0aW9uXTppbmZvXHJcbiAgICAvLyAgICAgICAgIH0pO1xyXG4gICAgLy8gICAgIH0gZWxzZSB7XHJcbiAgICAvLyAgICAgICAgIC8vIOS4unRydWXvvIzljbPlsIbooqvlj5bmtojvvIzliJnopoHmib7liLDlr7nlupRpbmZv5L2N572u5bCG5YW2572u56m6XHJcbiAgICAvLyAgICAgICAgIC8vIOi/memHjOi1i+WAvG51bGzmr5TotYvlgLx1bmRlZmluZWTlkoznqbropoHlpb1cclxuICAgIC8vICAgICAgICAgdGhhdC5zZXREYXRhKHtcclxuICAgIC8vICAgICAgICAgICAgIFtvcHRpb25dOm51bGxcclxuICAgIC8vICAgICAgICAgfSk7XHJcbiAgICAvLyAgICAgfVxyXG4gICAgLy8gICAgIC8vIOaUueWPmOagh+etvumAieS4reeKtuaAgVxyXG4gICAgLy8gICAgIHZhciBvcHRpb24gPSBcIm9wdGlvbltcIitpbmZvK1wiXS5pc1NlbGVjdFwiO1xyXG4gICAgLy8gICAgIHRoYXQuc2V0RGF0YSh7XHJcbiAgICAvLyAgICAgICAgIFtvcHRpb25dOiFpc1NlbGVjdFxyXG4gICAgLy8gICAgIH0pO1xyXG4gICAgLy8gICAgIC8vIOmBjeWOhm9wdGlvbu+8jOWmguaenOagh+etvumDveacquiiq+mAieS4re+8jOWImWxhYmVsQm945Li656m677yM6LWL57uZbGFiZWxCb3hJc051bGwg77yadHJ1ZSDlnKh3eG1s5LiK5LiN5LqI5pi+56S6XHJcbiAgICAvLyAgICAgbGV0IGlzTnVsbCA9IHRydWU7XHJcbiAgICAvLyAgICAgdGhhdC5kYXRhLm9wdGlvbi5mb3JFYWNoKChpdGVtOmFueSk9PntcclxuICAgIC8vICAgICAgICAgaWYgKGl0ZW0uaXNTZWxlY3QpIHtcclxuICAgIC8vICAgICAgICAgICAgIGlzTnVsbCA9IGZhbHNlO1xyXG4gICAgLy8gICAgICAgICB9XHJcbiAgICAvLyAgICAgfSlcclxuICAgIC8vICAgICB0aGF0LnNldERhdGEoe1xyXG4gICAgLy8gICAgICAgICBsYWJlbEJveElzTnVsbDppc051bGxcclxuICAgIC8vICAgICB9KTtcclxuICAgIC8vXHJcbiAgICAvLyB9LFxyXG4gICAgLy8g5p+l6K+i5omA5pyJ6KGM5Lia5oiW5oyJ6KGM5Lia5p+l6K+i5a6j6K6y5LyaXHJcbiAgICBnZXRBbGxCdXNpbmVzcyhidXNpbmVzcz86c3RyaW5nKXtcclxuICAgICAgICBjb25zdCB0aGF0ID0gdGhpcyBhcyBhbnk7XHJcbiAgICAgICAgaWYgKGJ1c2luZXNzKSB7XHJcbiAgICAgICAgICAgIC8vIOaMieihjOS4muafpeivolxyXG4gICAgICAgICAgICByZXF1ZXN0U2VydmljZS5nZXQoJ29ubGluZVByZXNlbnRhdGlvbnMvYnVzaW5lc3MvJyx7YnVzaW5lc3N9LHt9LHRydWUsdHJ1ZSlcclxuICAgICAgICAgICAgICAgIC50aGVuKHJlcz0+e1xyXG4gICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0RGF0YSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ubGluZVNlc3Npb246cmVzLmRhdGEuZGF0YVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICB9ZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIOaJgOaciVxyXG4gICAgICAgICAgICByZXF1ZXN0U2VydmljZS5nZXQoJ29ubGluZVByZXNlbnRhdGlvbnMvYnVzaW5lc3MvJyx7fSlcclxuICAgICAgICAgICAgICAgIC50aGVuKHJlcz0+e1xyXG4gICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0RGF0YSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbjpyZXMuZGF0YS5kYXRhXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgfSxcclxuICAgIC8vIOW+gOWxiueUn+etm+mAiVxyXG4gICAgaXNIaXN0b3J5KCl7XHJcbiAgICAgICAgY29uc3QgdGhhdCA9IHRoaXMgYXMgYW55O1xyXG4gICAgICAgIGlmICh0aGF0LmRhdGEuaXNIaXN0b3J5ID09ICcnKXtcclxuICAgICAgICAgICAgdGhhdC5zZXREYXRhKHtcclxuICAgICAgICAgICAgICAgIGlzSGlzdG9yeTp0cnVlXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1lbHNlIHtcclxuICAgICAgICAgICAgdGhhdC5zZXREYXRhKHtcclxuICAgICAgICAgICAgICAgIGlzSGlzdG9yeTohdGhhdC5kYXRhLmlzSGlzdG9yeVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfSxcclxuICAgIC8vIOWxleekuuW3suaUtuiXj1xyXG4gICAgaXNNeUNvbGxlY3QoKXtcclxuICAgICAgICBjb25zdCB0aGF0ID0gdGhpcyBhcyBhbnk7XHJcbiAgICAgICAgY29uc3QgYnVzaW5lc3MgPSBhdXRoZW5TZXJ2aWNlLmdldFVzZXJJZCgpO1xyXG4gICAgICAgIGlmICh0aGF0LmRhdGEuaXNNeUNvbGxlY3RlZCl7XHJcbiAgICAgICAgICAgIC8vIOeCueWHu+WPlua2iOafpeeci+aIkeeahOaUtuiXj++8jOafpeivouaJgOaciVxyXG4gICAgICAgICAgICB0aGF0LnNldERhdGEoe1xyXG4gICAgICAgICAgICAgICAgaXNNeUNvbGxlY3RlZDohdGhhdC5kYXRhLmlzTXlDb2xsZWN0ZWRcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8vIOaJgOaciVxyXG4gICAgICAgICAgICByZXF1ZXN0U2VydmljZS5nZXQoJ29ubGluZVByZXNlbnRhdGlvbnMvJyx7fSlcclxuICAgICAgICAgICAgICAgIC50aGVuKHJlcz0+e1xyXG4gICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0RGF0YSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ubGluZVNlc3Npb246cmVzLmRhdGEuZGF0YVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfWVsc2Uge1xyXG4gICAgICAgICAgICAvLyDngrnlh7vmn6XnnIvmiJHnmoTmlLbol49cclxuICAgICAgICAgICAgdGhhdC5zZXREYXRhKHtcclxuICAgICAgICAgICAgICAgIGlzTXlDb2xsZWN0ZWQ6dHJ1ZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmVxdWVzdFNlcnZpY2UuZ2V0KFwiY29sbGVjdC9vbmxpbmVQcmVzZW50YXRpb25zL3VzZXIvXCIse2J1c2luZXNzfSx7fSx0cnVlLHRydWUpXHJcbiAgICAgICAgICAgICAgICAudGhlbihyZXM9PntcclxuICAgICAgICAgICAgICAgICAgICB0aGF0LnNldERhdGEoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbmxpbmVTZXNzaW9uOnJlcy5kYXRhLmRhdGFcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcbiAgICAvLyDojrflj5bliankuIvpq5jluqbnu5lzY3JvbGx2aWV355SoXHJcbiAgICBjb21wdXRlU2Nyb2xsVmlld0hlaWdodCgpIHtcclxuICAgICAgICBjb25zdCB0aGF0ID0gdGhpcyBhcyBhbnk7XHJcbiAgICAgICAgLy8g6L+U5Zue5LiA5LiqIFNlbGVjdG9yUXVlcnkg5a+56LGh5a6e5L6LXHJcbiAgICAgICAgbGV0IHF1ZXJ5ID0gd3guY3JlYXRlU2VsZWN0b3JRdWVyeSgpO1xyXG4gICAgICAgIC8vIOWcqOW9k+WJjemhtemdouS4i+mAieaLqeesrOS4gOS4quWMuemFjemAieaLqeWZqCBzZWxlY3RvciDnmoToioLngrnjgILov5Tlm57kuIDkuKogTm9kZXNSZWYg5a+56LGh5a6e5L6L77yM5Y+v5Lul55So5LqO6I635Y+W6IqC54K55L+h5oGvXHJcbiAgICAgICAgcXVlcnkuc2VsZWN0KCcuc3dpcGVyLXdyYXAnKS5ib3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICBxdWVyeS5zZWxlY3QoJy5jb250ZW50SGVhZCcpLmJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgIC8vIOaJp+ihjOaJgOacieeahOivt+axguOAguivt+axgue7k+aenOaMieivt+axguasoeW6j+aehOaIkOaVsOe7hO+8jOWcqGNhbGxiYWNr55qE56ys5LiA5Liq5Y+C5pWw5Lit6L+U5ZueXHJcbiAgICAgICAgcXVlcnkuZXhlYyhyZXMgPT4ge1xyXG4gICAgICAgICAgICBsZXQgc3dpcGVySGVpZ2h0ID0gcmVzWzBdLmhlaWdodDtcclxuICAgICAgICAgICAgbGV0IGhlYWRIZWlnaHQgPSByZXNbMV0uaGVpZ2h0O1xyXG4gICAgICAgICAgICAvLyB3eC5nZXRTeXN0ZW1JbmZvU3luYygpIOWPr+S7peW+l+WIsOiuvuWkh+eahOWQhOenjeS/oeaBr++8jOWFs+S6jumrmOW6pueahOWPguaVsOacieS4pOS4qu+8jOS4gOS4quaYr+Wxj+W5lemrmOW6piBzY3JlZW5IZWlnaHTvvIzkuIDkuKrmmK/lj6/kvb/nlKjnqpflj6Ppq5jluqYgd2luZG93SGVpZ2h044CC5rOo5oSP6K6h566X55qE5pe25YCZ6KaB55SoIHdpbmRvd0hlaWdodO+8jOi/meagt+eul+WHuuadpeeahOmrmOW6puaJjeaYr+WvueeahOOAgnNjcmVlbkhlaWdodOaYr+aJi+acuueahOWxj+W5lemrmOW6pu+8jOWMheWQq+S6huaJi+acuueahOeKtuaAgeagj+WSjOWwj+eoi+W6j+agh+mimOagj+OAglxyXG4gICAgICAgICAgICBsZXQgd2luZG93SGVpZ2h0ID0gd3guZ2V0U3lzdGVtSW5mb1N5bmMoKS53aW5kb3dIZWlnaHQ7XHJcbiAgICAgICAgICAgIC8vIDUw5pivdGFi6auY5bqmXHJcbiAgICAgICAgICAgIGxldCBzY3JvbGxIZWlnaHQgPSB3aW5kb3dIZWlnaHQgLSBzd2lwZXJIZWlnaHQgLSBoZWFkSGVpZ2h0IC0gNTA7XHJcbiAgICAgICAgICAgIHRoYXQuc2V0RGF0YSh7XHJcbiAgICAgICAgICAgICAgICBzY3JvbGxIZWlnaHQ6IHNjcm9sbEhlaWdodFxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcbiAgICB9LFxyXG4gICAgdG9DbG91ZChlOmFueSl7XHJcbiAgICAgICAgY29uc3QgdGhhdCA9IHRoaXMgYXMgYW55O1xyXG4gICAgICAgIGxldCBpbmZvID0gZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuaW5mbztcclxuICAgICAgICBsZXQgZGF0YSA9IHRoYXQuZGF0YS5vbmxpbmVTZXNzaW9uW2luZm9dO1xyXG4gICAgICAgIGNvbnN0IHNlbmREYXRhID0gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XHJcbiAgICAgICAgd3gubmF2aWdhdGVUbyh7XHJcbiAgICAgICAgICAgIHVybDonLi4vY2xvdWQvY2xvdWQ/ZGF0YT0nICsgc2VuZERhdGFcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG59KVxyXG4iXX0=